## A reproduction code for generating semantic IDs in "Transformer Memory as a Differentiable Search Index".
Semantically Structured Identifiers are commonly used in generative IR models recently, and have deen proved effective in improving the search performance in multiple works.
This repository provide an implementation of generating semantic ids with embeddings give by Language Models (e.g. BERT).

The code is written based on the description in the [original paper](https://arxiv.org/abs/2202.06991):
<div align=center>
<img src=./semantic.png width=50% />
</div>

Four parameters are needed to run this script:
<ul>
    <li><i>embedding_path </i>: The embedding file of the corpus. The embeddings are usually generated by language models such as BERT. The format of the file should be <i>.jsonl</i>. 
         We give an <i>example_embeddings.jsonl</i> file in our repository. For each line in the embedding file, the json items contains two fields: the original document <b>id</b>, and 
         the embedding <b>vector</b> given by language models.</li>
    <li><i>output_dir </i>: The output dir of the semantic id file. This should be a directory.  </li>
    <li><i>num_cluster </i>: The cluster number of each step when performing K-Means. The default value is 10. </li> 
    <li><i>cluster_size </i>: The max number of docs in final cluster. The default value is 100. </li> 
 </ul>